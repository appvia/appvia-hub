<div class="list-group-item bg-light">
  <%= tag.span(resource.status, class: "badge badge-#{resource_status_class(resource.status)} float-right ml-3") %>

  <h6 class="text-primary">
    <%= resource.name %>

    <span class="text-muted ml-2">
      on <%= resource.integration.name %>
    </span>
  </h6>

  <% unless resource.pending? %>
    <p>
      <%- case resource -%>
      <%- when Resources::CodeRepo -%>
        <%= resource.private ? 'Private' : 'Public' %><br />
        <%= link_to resource.full_name, resource.url, target: '_blank' %>
      <%- when Resources::DockerRepo -%>
        <%= resource.visibility.try(:capitalize) %><br />
        <%= resource.base_uri %>
      <%- when Resources::KubeNamespace -%>
      <%- end -%>
    </p>

    <% credentials = global_credentials_for resource %>
    <% if credentials.present? %>
      <% panel_id = "credentials-panel-#{resource.id}" %>
      <%=
        tag.a(
          href: '#',
          data: {
            toggle: 'collapse',
            target: "##{panel_id}"
          },
          aria: {
            controls: panel_id
          }
        ) do
      %>
        Credentials
      <% end %>

      <%=
        tag.div(
          id: panel_id,
          class: 'card-body collapse'
        ) do
      %>
        <dl class="mb-0 overflow-auto">
          <% credentials.each do |(k, v)| %>
            <dt><%= k -%></dt>
            <dd class="text-wrap text-break"><%= v -%></dd>
          <% end %>
        </dl>
      <% end %>
    <% end %>

    <div>
      <div class="btn-group float-right" role="group" aria-label="Resource actions">
        <button id="resource<%= resource.id -%>ActionsGroupDropdown" type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Actions
        </button>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="resource<%= resource.id -%>ActionsGroupDropdown">
          <%= delete_resource_link resource.project_id, resource, css_class: 'dropdown-item' %>
        </div>
      </div>
    </div>
  <% end %>
</div>
